<app-dots-loader *ngIf="isLoader"></app-dots-loader>

<div class="container">
    <section id="tabs" class="project-tab">
        <div class="container">
            <div class="row m-0">
                <div class="col-lg-12 col-md-12 col-sm-12">
                    <nav>
                        <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                            <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#addPlan" role="tab" aria-controls="nav-home" aria-selected="true">Add Plan</a>
                            <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#addMessage" role="tab" aria-controls="nav-profile" aria-selected="false">Add Message</a>
                        </div>
                    </nav>
                    <div class="tab-content" id="nav-tabContent">
                        <div class="tab-pane fade show active" id="addPlan" role="tabpanel" aria-labelledby="nav-home-tab">
                            <form #form="ngForm" (ngSubmit)="onSubmit(form)" novalidate autocomplete="off">
                                <div class="container">

                                    <div class="row mt-3">
                                        <div class="form-group col-lg-5 offset-lg-1 col-md-6 col-sm-12">
                                            <label class="form-control-label" for="planName">Plan Name</label>
                                            <input name="planName" placeholder="Enter Plan name" id="planName" trim="blur" class="form-control" [class.is-invalid]="planName.invalid && (planName.touched || form.submitted)" required [(ngModel)]="model.planName" #planName="ngModel" />
                                        </div>
                                        <div class="form-group col-lg-5 col-md-6 col-sm-12">
                                            <label class="form-control-label" for="planId">Plan Code</label>
                                            <input name="planId" id="planId" placeholder="Enter Plan Code" class="form-control" trim="blur" [class.is-invalid]="planId.invalid && (planId.touched || form.submitted)" required [(ngModel)]="model.planId" #planId="ngModel" />
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="form-group col-lg-5 col-md-6 offset-lg-1 col-sm-12">
                                            <label class="form-control-label" for="energy">Clean Energy</label>
                                            <div class="input-group">
                                                <input name="energy" id="energy" placeholder="Enter Clean Energy" class="form-control" trim="blur" [class.is-invalid]="energy.invalid && (energy.touched || form.submitted)" required [(ngModel)]="model.energy" #energy="ngModel" />
                                                <div class="input-group-append">
                                                    <span class="input-group-text">%</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-5 col-md-6 col-sm-12">
                                            <label class="form-control-label" for="discount">Discount</label>
                                            <div class="input-group">
                                                <input name="discount" id="discount" placeholder="Enter Discount" class="form-control" trim="blur" [(ngModel)]="model.discount" #discount="ngModel" />
                                                <div class="input-group-append">
                                                    <div class="input-group-text">%</div>
                                                </div>

                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="form-group col-lg-5 col-md-6 offset-lg-1 col-sm-12">
                                            <label class="form-control-label" for="planInMonths">Contract Term</label>

                                            <select name="planInMonths" placeholder="" id="planInMonths" class="form-control select-font" [class.is-invalid]="planInMonths.invalid && (planInMonths.touched || form.submitted)" required [(ngModel)]="model.planInMonths" (change)="onSelectContractTerm($event)" #planInMonths="ngModel">
                                    <option value='' ng-selected="selected" disabled>Select Contract Term</option>
                                   <option *ngFor="let month of months" [value]="month" class="option-font ">{{ month }}</option>
                                   <!-- <option  class="option-font ">Others</option>    -->
                                 </select>
                                            <div *ngIf="planInMonths.invalid && (planInMonths.touched || form.submitted) " class="invalid-feedback ">
                                                <div *ngIf="planInMonths?.errors.required ">
                                                    <i>Contract term is required</i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group col-lg-5 col-md-6 col-sm-12">
                                            <label class="form-control-label" for="planType">Plan Type</label>

                                            <select name="planType" id="planType" class="form-control select-font" [class.is-invalid]="planType.invalid && (planType.touched || form.submitted)" required [(ngModel)]="model.planType" (change)="onSelectPlanType($event)" #planType="ngModel">
                                                <option value='' ng-selected="selected " disabled>Select Plan Type</option>
                                               <option  value="DOT" class="option-font ">DOT</option>
                                               <option  value="FIX" class="option-font ">FIX</option>   
                                               <!-- <option value="other" class="option-font ">Others</option>    -->
                                             </select>

                                            <input *ngIf="planTypeOthers" type="text" name="planType" class="form-control">
                                            <div *ngIf="planType.invalid && (planType.touched || form.submitted) " class="invalid-feedback ">
                                                <div *ngIf="planType?.errors.required ">
                                                    <i>Plan type is required</i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="form-group col-lg-5 col-md-6 offset-lg-1 col-sm-12">
                                            <label class="form-control-label" for="rate">Rate (Before GST)</label>

                                            <input name="rate" id="rate" placeholder="Enter Rate" class="form-control" trim="blur" [class.is-invalid]="rate.invalid && (rate.touched || form.submitted)" required [(ngModel)]="model.rate" #rate="ngModel" />


                                        </div>
                                        <div class="form-group col-lg-5 col-md-6 col-sm-12">
                                            <label class="form-control-label" for="afterGst">Rate (After GST)</label>

                                            <input name="afterGst" id="afterGst"  placeholder="Enter Rate" class="form-control" trim="blur" [class.is-invalid]="afterGst.invalid && (afterGst.touched || form.submitted)" required [(ngModel)]="model.afterGst" #afterGst="ngModel" />

                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="form-group col-lg-5 offset-lg-1 col-md-6 col-sm-12">
                                            <label class="form-control-label" for="rateChange">Comments/Remarks</label>
                                            <input name="rateChange"  placeholder="Enter Comments" id="rateChange" class="form-control" trim="blur" [(ngModel)]="model.rateChange" #rateChange="ngModel" />
                                        </div>
                                        <div class="form-group col-lg-5 col-md-6 col-xs-12">
                                            <label class="form-control-label" for="factSheet">Upload Fact Sheet</label>
                                            <input type="text" name="factSheet" placeholder="Upload Sheet" class="form-control fileUpload" [(ngModel)]="myfile" disabled required #myfile1="ngModel">
                                            <div class="upload-btn-wrapper">
                                                <label class="btnUpload" for="file">Upload</label>
                                                <input type="file" id="file" name="myfile" accept="application/pdf" (change)="onFileSelected($event)" />
                                            </div>
                                            <ng-container class="valid-feedback" *ngIf="uploadSuccess">
                                                <span style="font-style: italic; color: green; float: left">Uploaded Successfully</span>
                                            </ng-container>
                                        </div>
                                    </div>
                                    <div class="col-12 pt-4 pb-4">
                                        <button class="btn step-next mx-auto" type="submit">
                                            <span>Add</span>
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="tab-pane fade" id="addMessage" role="tabpanel" aria-labelledby="nav-profile-tab">
                            <form (ngSubmit)="f.form.valid && addMessage()" #f="ngForm" name="form">
                                <div class="container">

                                    <div class="form-group row col-lg-6 offset-lg-3 col-xs-12 mt-4">
                                        <label for="comment"><strong>Message:</strong></label>
                                        <textarea class="form-control" rows="5" id="comment" [(ngModel)]="msgModal.message" name="message" required #message="ngModel"></textarea>

                                        <div *ngIf="f.submitted && message.invalid" class="alert-danger" style="color: #ffffff;
                                        background-color: #eb4e5d;
                                        /* margin: 1%; */
                                        border-color: #f5c6cb;
                                        width: 100%;
                                        margin-top: 2%;
                                        padding: 5px;">

                                             <div *ngIf="message.errors.required">   Message is required. </div>

                                        </div>

                                        <br>

                                        <button type="submit"  class="btn btn-success mt-3" style="width: 100px;">Add</button>
                                        <button class="btn btn-danger mt-3 ml-3" style="width: 100px;" (click)="deleteMessage()">Delete</button>

                                    </div>
                                </div>
                            </form>

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </section>
</div>